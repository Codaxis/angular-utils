angular.module("angularUtils",["angularUtils.ajaxLoader","angularUtils.apiResource","angularUtils.digitsOnly","angularUtils.filters","angularUtils.formUtils","angularUtils.monthPicker","angularUtils.paginationHeaders"]),angular.module("angularUtils.ajaxLoader",[]).directive("ajaxLoader",function(){return{template:'<div class="ajax-loader-container" ng-show="showLoader"><div class="ajax-loader"></div></div>',scope:{},link:function(a){return a.showLoader=!1,a.$on("ajax-loader:show",function(){a.showLoader=!0}),a.$on("ajax-loader:hide",function(){a.showLoader=!1}),a}}}).factory("httpInterceptor",["$q","$rootScope",function(a,b){var c=0,d=function(a){return a.headers&&a.headers.ajaxLoader===!1&&(delete a.headers.ajaxLoader,a.ajaxLoader=!1),a.ajaxLoader===!1?!0:!1};return{request:function(e){return d(e)||(c++,b.$broadcast("ajax-loader:show")),e||a.when(e)},response:function(e){return d(e.config)||0!==--c||b.$broadcast("ajax-loader:hide"),e||a.when(e)},responseError:function(e){return d(e.config)||0!==--c||b.$broadcast("ajax-loader:hide"),a.reject(e)}}}]).config(function(a){a.interceptors.push("httpInterceptor")}),angular.module("angularUtils.apiResource",["ngResource"]).provider("apiResource",function(){var a="/api";return{setBaseUrl:function(b){a=b},getBaseUrl:function(){return a},$get:["$resource",function(b){return function(c,d,e,f,g){if("undefined"==typeof c||null==c)throw"Resource URL can't be empty";e=e||{},g=g||{},f=f||{};var h;if("object"==typeof c?(h=c.baseUrl?c.baseUrl:a,c=c.name):h=a,"/"!=h.charAt(0))throw'Resource base url must start with "/"';for(var i in e)-1==["get","save","query","remove","delete"].indexOf(i)&&(e[i].url||e[i].resourceUrl?e[i].resourceUrl&&(e[i].url=h+"/"+c+("/"==e[i].resourceUrl?e[i].resourceUrl:"/"+e[i].resourceUrl),delete e[i].resourceUrl):e[i].url=h+"/"+c+"/"+i+"/:id");var j={$save:function(){return this.id?this.$update():this.$create()}};g=angular.extend(j,g);var k={get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},"delete":{method:"DELETE"},update:{method:"PUT",isArray:!1},create:{method:"POST"}};e=angular.extend(k,e);var l=b(h+"/"+c+"/:id",d,e);return angular.extend(l,f),angular.extend(l.prototype,g),l.url=function(){return h+"/"+c},l.getParamDefaults=function(){return d},l.getActions=function(){return e},l}}]}}),angular.module("angularUtils.digitsOnly",[]).directive("digitsOnly",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){d.$parsers.push(function(a){var b=a?a.replace(/[^\d]/g,""):null;return b!=a&&(d.$setViewValue(b),d.$render()),b})}}}),angular.module("angularUtils.filters",[]).filter("zpad",function(){return function(a,b){if("undefined"==typeof a?a="":"number"==typeof a&&(a=a.toString()),a.length>=b)return a;var c="0".repeat(b);return(c+a).slice(-1*b)}}).filter("replace",function(){return function(a,b,c){return a.replace(new RegExp(b,"g"),c)}}),angular.module("angularUtils.formUtils",[]).directive("storeLabels",[function(){return{restrict:"AC",require:"^form",link:function(a,b){var c={};b.find("[name]").each(function(a,b){var d=$(b);c[d.attr("name")]=d.closest(".form-group").find(".control-label").text()}),a.$inputLabels=c}}}]).directive("markRequired",[function(){return{restrict:"AC",require:"^form",link:function(a,b){b.find("[required]").each(function(a,b){$(b).closest(".form-group").addClass("required")})}}}]).directive("formShowErrors",["$compile",function(){var a=function(a,b){var c=a.attr(a.attr("name")?"name":"ng-form");if(!c)throw'Form has no "name" or "ng-form" attribute';a.find(".form-control[name]").each(function(a,d){var e=$(d),f=e.attr("name"),g=e.closest(".form-group");g.attr("show-errors",!0);var h=c+"."+f,i=$("<div/>").addClass("help-block").attr({"ng-messages":h+".$error","ng-messages-include":b.formShowErrors,"ng-show":h+".$touched && "+h+".$invalid"}),j=g.find("[errors-container="+f+"]");j.length||(j=g.find(".errors-container, [errors-container]")),j.length?j.html(i):e.after(i)})};return{restrict:"A",require:"^form",compile:a}}]).directive("validFile",[function(){return{require:"ngModel",link:function(a,b,c,d){b.bind("change",function(){a.$apply(function(){d.$setViewValue(b[0].files.length?b[0].files[0]:null),d.$render()})})}}}]),angular.module("angularUtils.monthPicker",[]).directive("monthPicker",["$timeout","moment",function(a,b){return{restrict:"A",require:"ngModel",link:function(c,d,e,f){var g=$(d).datetimepicker({format:"MM/YYYY",viewMode:"years",icons:{time:"fa fa-time",date:"fa fa-calendar",up:"fa fa-chevron-up",down:"fa fa-chevron-down",previous:"fa fa-chevron-left",next:"fa fa-chevron-right",today:"fa fa-screenshot",clear:"fa fa-trash"}}).on("dp.change",function(a){f.$setViewValue(a.date.format("YYYYMM")),c.$apply()});c.$watch(function(){return f.$modelValue},function(c){a(function(){g.data("DateTimePicker").date(b(c,"YYYYMM"))})})}}}]),angular.module("angularUtils.pagination",[]).directive("paginationHeaders",function(){return{template:'      <th ng-repeat="column in processedColumns" class="{{column.class}}">        <a ng-click="sort(column)" ng-if="column.sort">          {{column.label}}          <i class="fa fa-{{sortUpIcon}} pull-right" ng-show="column.active && column.direction==\'asc\'"></i>          <i class="fa fa-{{sortDownIcon}} pull-right" ng-show="column.active && column.direction==\'desc\'"></i>        </a>        <span ng-if="!column.sort">{{column.label}}</span>      </th>      ',scope:{columns:"=",sortFn:"&",sortUpIcon:"=?",sortDownIcon:"=?"},link:function(a){a.sortUpIcon=a.sortUpIcon||"caret-up",a.sortDownIcon=a.sortDownIcon||"caret-down",a.processedColumns=a.columns.map(function(a){return a.label||(a.label=a.id.charAt(0).toUpperCase()+a.id.slice(1)),a["class"]||(a["class"]="column-"+a.id),a.direction=null,a.active=!1,a}),a.sort=function(b){a.processedColumns.forEach(function(a){a.active=!1}),b.active=!0,b.direction=null===b.direction?"asc":"asc"==b.direction?"desc":"asc",a.sortFn({config:{sort:b.id,direction:b.direction}})}}}});